theus_fodelsedag:
  alias: Theus födelsedag
  sequence:
    - service: media_player.volume_set
      entity_id:
        - media_player.hallen
        - media_player.kitchen_speaker
      data:
        volume_level: 0.3
    - service: media_player.play_media
      data:
        entity_id:
          - media_player.hallen
          - media_player.kitchen_speaker
          - media_player.kitchen_mini
        media_content_id: !secret content_silence_mp3
        media_content_type: music
    - delay: '00:00:05'
    - service: tts.google_translate_say
      entity_id:
        - media_player.hallen
        - media_player.kitchen_speaker
      data_template:
        message: >
          {% if now().strftime("%b") == "Sep" and now().strftime("%-d") == "02"%}
            {% set yearDiff = now().strftime("%Y") | int - 2014 %}
            {% set monthDiff = now().strftime("%m") | int - 09 %}
            {% set dayDiff = now().strftime("%d") | int - 02 %}
            {% if dayDiff < 0 or monthDiff < 0 %}
              {% set age = yearDiff %}
            {% else %}
              {% set age = yearDiff %}
            {% endif %}
            Grattis idag fyller du {{ age }} år Theus!
            {% endif %}